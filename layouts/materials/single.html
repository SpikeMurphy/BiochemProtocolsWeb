{{ define "main" }}

    {{/* Slug aus der URL holen */}}
    {{ $slug := path.Base .Permalink }}

    {{/* Slug wieder zu TOML-Key umwandeln: Bindestriche -> Unterstriche */}}
    {{ $key := replace $slug "-" "_" }}

    {{/* Nun Material-Daten holen */}}
    {{ $mat := index site.Data.materials $key }}

    {{ if not $mat }}
        <h1>Material not found</h1>
        <p>No entry for "<code>{{ $key }}</code>" exists.</p>
    {{ else }}

        <h1>{{ $mat.name }}</h1>

        <p><strong>Categories:</strong> {{ delimit $mat.category ", " }}</p>

        <h2>Locations</h2>
        <ul>
        {{ range $mat.locations }}
            <li>{{ .name }} â€” {{ .amount }} {{ $mat.unit }}</li>
        {{ end }}
        </ul>

        <h2>Total Amount</h2>
        {{ $total := 0 }}
        {{ range $mat.locations }}
            {{ $total = add $total .amount }}
        {{ end }}
        <p><strong>{{ $total }} {{ $mat.unit }}</strong></p>

        <h2>Raw TOML</h2>
        <pre>{{ $mat | jsonify (dict "indent" "  ") }}</pre>

    {{ end }}

{{ end }}
